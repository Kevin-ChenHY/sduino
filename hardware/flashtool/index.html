<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Michael Mayer">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Flash tool - Sduino</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">Sduino</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../..">Introduction</a>
</li>
                                    
<li >
    <a href="../../usage/board-manager-install/">Automatic Installation</a>
</li>
                                    
<li >
    <a href="../../usage/build-ide/">Building with the IDE</a>
</li>
                                    
<li >
    <a href="../../usage/faq/">FAQ/common problems</a>
</li>
                                    
<li >
    <a href="../../usage/why-stm8/">When to use an STM8S - and when not</a>
</li>
                                    
<li >
    <a href="../../usage/manual-install/">Manual Installation</a>
</li>
                                    
<li >
    <a href="../../usage/build-cli/">Building with a Makefile</a>
</li>
                                    
<li >
    <a href="../../usage/limitations/">Limitations</a>
</li>
                                    
<li >
    <a href="../../usage/status-todo/">Status and todo</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Libraries <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../api/migration/">API description and migration guidelines</a>
</li>
                                    
<li >
    <a href="../../api/Print/">Print</a>
</li>
                                    
<li >
    <a href="../../api/HardwareSerial/">HardwareSerial</a>
</li>
                                    
<li >
    <a href="../../api/SPI/">SPI</a>
</li>
                                    
<li >
    <a href="../../api/Wire/">Wire</a>
</li>
                                    
<li >
    <a href="../../api/I2C/">I2C</a>
</li>
                                    
<li >
    <a href="../../api/EEPROM/">EEPROM</a>
</li>
                                    
<li >
    <a href="../../api/LiquidCrystal/">LiquidCrystal character LCD library</a>
</li>
                                    
<li >
    <a href="../../api/LiquidCrystal_I2C/">LiquidCrystal_I2C character LCD connected via I2C backpack boards</a>
</li>
                                    
<li >
    <a href="../../api/LiquidCrystal_pcf2119/">LiquidCrystal_pcf2119 character LCD connected via I2C</a>
</li>
                                    
<li >
    <a href="../../api/PCD8544/">PCD8544 libray for Nokia 5110-like graphical LCDs</a>
</li>
                                    
<li >
    <a href="../../api/Mini_SSD1306/">Mini_SSD1306 library for monochrome OLED-displays</a>
</li>
                                    
<li >
    <a href="../../api/Stepper/">Stepper library</a>
</li>
                                    
<li >
    <a href="../../api/Servo/">Servo library</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hardware <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li class="active">
    <a href="./">Flash tool</a>
</li>
                                    
<li >
    <a href="../stm8blue/">Generic STM8S103F3 breakout board (stm8blue)</a>
</li>
                                    
<li >
    <a href="../stm8s003/">Generic STM8S003 support</a>
</li>
                                    
<li >
    <a href="../esp14/">ESP14 Wifi board (STM8S003F3P6)</a>
</li>
                                    
<li >
    <a href="../w1209-thermostat/">W1209 thermostat board (STM8S003F3P6)</a>
</li>
                                    
<li >
    <a href="../stm8sblack/">Generic STM8S105K4 breakout board (stm8sblack)</a>
</li>
                                    
<li >
    <a href="../stm8sdiscovery/">STM8S105Discovery evaluation board made by ST (STM8S105C6)</a>
</li>
                                    
<li >
    <a href="https://github.com/roybaer/sduino_uno">sduino Uno (STM8S105K6), inspired by Arduino Uno</a>
</li>
                                    
<li >
    <a href="https://github.com/roybaer/sduino_mb">sduino MB (STM8S208MB), inspired by Arduino Mega</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developer Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../developer/ide-integration/">IDE integration</a>
</li>
                                    
<li >
    <a href="../../developer/compiling-the-tools/">Compiling the tools</a>
</li>
                                    
<li >
    <a href="../../developer/cross-compile-for-osx/">Cross-compiling the tools for OSX</a>
</li>
                                    
<li >
    <a href="../../developer/update-to-manual/">Update an automatic installation to a manual installation</a>
</li>
                                    
<li >
    <a href="../../developer/macro/">C preprocessor macro magic</a>
</li>
                                    
<li >
    <a href="../../developer/pin_mapping/">Ways to define a pin mapping</a>
</li>
                                    
<li >
    <a href="../../developer/coding-style/">Coding style</a>
</li>
                                    
<li >
    <a href="../../developer/sdcc/">Using the SDCC compiler</a>
</li>
                                    
<li >
    <a href="../../developer/spl/">Using the SPL with SDCC and sduino</a>
</li>
                                    
<li >
    <a href="../../developer/bare-metal-programming/">Bare metal programming on the STM8</a>
</li>
                                    
<li >
    <a href="../../developer/optimizations/">Optimizations</a>
</li>
                                    
<li >
    <a href="../../developer/performance/">Performance comparison and benchmarking</a>
</li>
                                    
<li >
    <a href="../../developer/links/">Links and further reading</a>
</li>
                                </ul>
                            </li>
                            <li >
                                <a href="../../contact/">Contact</a>
                            </li>
                            <li >
                                <a href="../../about/">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../../api/Servo/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../stm8blue/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/tenbaht/sduino/edit/master/docs/hardware/flashtool.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#flash-tool">Flash tool</a></li>
            <li><a href="#classic-st-link-v2-flash-tools">Classic ST-Link V2 flash tools</a></li>
            <li><a href="#pinout">Pinout</a></li>
            <li><a href="#installation-for-linux">Installation for Linux</a></li>
            <li><a href="#installation-for-windows">Installation for Windows</a></li>
            <li><a href="#connection-to-the-cpu-board">Connection to the CPU board</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="flash-tool">Flash tool</h1>
<p>The STM8-Discovery-Boards come with an integrated ST-Link-Interface, but for
any other board you need a special flash tools in order to program the CPU.
These litte devices look like a generic USB thumb drive and are sold for
well under $3 on aliexpress, just search for st-link.</p>
<p>As far as I know there is no solution to use a regular Arduino board as a
SWIM-capable flash programmer. The <a href="http://jcwolfram.de/projekte/uprog2/main.php">universal programmer
uprog2</a> (website in german
only) is based on an ATmega664 and it might be possible to use an Arduino
Mega board with this software (untested).</p>
<p><a href="https://github.com/rumpeltux/esp-stlink">esp-stlink</a> is a ST-Link
programmer based on the ESP8266. It allows programming an STM8 via a Wifi
connection. The use of this programmer is supported by stm8flash now, but
not yet integrated into the Arduino IDE. I didn't test this yet.</p>
<h2 id="classic-st-link-v2-flash-tools">Classic ST-Link V2 flash tools</h2>
<p>There are two main versions of the ST-Link V2 compatible flash tool
available: One in a USB-Drive-like metal housing (often pink or blue) and
one made by Baite in a green plastic housing. Both work well, but they use a
different pinout.</p>
<p><img alt="Picture of both flash tools" src="../ST-LinkV2_pinout_01.jpg" /></p>
<p>Both flash tools support the SWIM protocol for STM8 CPUs and the SWD
protocol for the STM32 CPUs. The programmer from Baite additionally supports
JTAG and is slightly superior to the more common one in the metal housing.</p>
<h2 id="pinout">Pinout</h2>
<p>Recently, very similar looking versions of the metal housing flash tool, but
with different pinouts, have been seen. Make sure to check your specific
tool before building cables! <a href="https://wiki.cuvoodoo.info/doku.php?id=jtag">More information on the hardware and the
pinouts</a></p>
<p>Pinout of Chinese ST-Link V2-clone made by Baite with green plasic housing
(supports SWIM, SWD and JTAG):</p>
<pre><code>            +-----+
    T_JRST  | 1  2| 3V3
    5V      | 3  4| T_JTCK/T_SWCLK
    SWIM      5  6| T_JTMS/T_SWDIO
    GND     | 7  8| T_JTDO
    SWIM RST| 9 10| T_JTDI
            +-----+
</code></pre>
<p>Pinout of Chinese ST-Link V2-clone with metal housing (supports SWIM and
SWD):</p>
<pre><code>            +-----+
    RST     | 1  2| SWDIO
    GND     | 3  4| GND
    SWIM      5  6| SWCLK
    3V3     | 7  8| 3V3
    5V      | 9 10| 5V
            +-----+
</code></pre>
<h2 id="installation-for-linux">Installation for Linux</h2>
<p>Save this as root in in <code>/etc/udev/rules.d/99-stlink.rules</code>:</p>
<pre><code># ST-Link/V2 programming adapter

# ST-Link V1, if using a STM8S discovery board
# important: It needs a special entry in /etc/modprob/blacklist
ATTR{idVendor}=="0483", ATTR{idProduct}=="3744", MODE="0666", GROUP="plugdev"

# ST-Link/V2, the china adapter with the green plastic housing
ATTR{idVendor}=="0483", ATTR{idProduct}=="3748", MODE="0666", GROUP="plugdev"
</code></pre>
<p>Using the STM8S-Discovery board as a flash programmer is a special case and
requires <a href="Dstm8sdiscovery#usage-with-linux-and-stm8flash">some additional
blacklisting</a>.</p>
<h2 id="installation-for-windows">Installation for Windows</h2>
<p>Download and install the ST-Link/v2 driver <strong>before you plug in the flash
tool</strong>:
<a href="http://www.st.com/en/development-tools/stsw-link009.html">STSW-LINK009 driver download</a>
(Registration required, but very easy)</p>
<p>I would love to include this driver with the Sduino install package, but I
am not sure if this is covered by the ST licence terms for the driver.</p>
<h2 id="connection-to-the-cpu-board">Connection to the CPU board</h2>
<p>The pinout of the SWIM connector P3 on my STM8S103 breakout board fits the
pinout of the flash tool in the metal housing perfectly:</p>
<table>
<thead>
<tr>
<th>Signal</th>
<th align="center">SWIM connector P3</th>
<th align="center">Baite ST-Link</th>
<th align="center">Metal ST-Link</th>
</tr>
</thead>
<tbody>
<tr>
<td>3V3</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">7</td>
</tr>
<tr>
<td>SWIM</td>
<td align="center">2</td>
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr>
<td>GND</td>
<td align="center">3</td>
<td align="center">7</td>
<td align="center">3</td>
</tr>
<tr>
<td>NRST</td>
<td align="center">4</td>
<td align="center">9</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>The Discovery boards made by ST all feature a ST-Link interface as well, but
only the Discovery STM8S105 supports the SWIM protocol. The Discovery
STM32F0308 implements SWD only and is not usable for the STM8.</p>
<table>
<thead>
<tr>
<th>Pin out CN3</th>
<th>SWD</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>? detect oder so?</td>
</tr>
<tr>
<td>2</td>
<td>JTCK/SWCLK</td>
</tr>
<tr>
<td>3</td>
<td>GND</td>
</tr>
<tr>
<td>4</td>
<td>JTMS/SWDIO</td>
</tr>
<tr>
<td>5</td>
<td>NRST</td>
</tr>
<tr>
<td>6</td>
<td>SWO</td>
</tr>
</tbody>
</table></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
